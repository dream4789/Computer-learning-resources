<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<title>Document</title>
		<script src="../lib/vue2.7.8.js"></script>
	</head>

	<body>
		<div class="app">
			<button @click="add">+1</button>
			<span ref="cur">{{count}}</span>
			<button @click="sub">-1</button>
			<button @click="handle">销毁vm</button>
			<button @click="print">打印btn</button>
		</div>

		<script>
			let vm = new Vue({
				el: ".app",
				data() {
					return {
						name: 'aaa',
						count: 0,
						that: ''
					}
				},
				methods: {
					add() {
						this.count++
					},
					sub() {
						this.count--
					},
					handle() {
						console.log("handle...");
						console.log('handle---', document.getElementsByTagName('button'));
						this.$destroy();
					},
					print() {
						console.log('print---', document.getElementsByTagName('button'));
					}
				},


				// beforeCreate
				// vm  还没有初始化完毕  
				// 不能访问data中的数据，不能调用methods中的方法
				// 项目中，不怎么用，了解
				beforeCreate() {
					console.log("\n------------------- 初始化前阶段：beforeCreate -------------------");
					console.log(this.name, this.count, this); // undefined undefined Vue{}
					console.log(document.getElementsByTagName('button')); // 有输出 1

					this.count++;  // 不太正常，count未创建出来，为 NaN
					console.log(this.name, this.count, this); // undefined NaN Vue{}

					// this.print(); // 未找到函数，报错
					// this.handle(); // 未找到函数，报错
				},
				// vm实例已初始化完毕
				// 项目中：1）发送ajax请求  2）获取路由参数
				created() {
					console.log("\n------------------- 初始化阶段：created -------------------");
					console.log(this.name, this.count, this); // aaa 0 Vue{}
					this.print();  // 正常
					this.count++;  // 正常
					console.log(this.name, this.count, this); // aaa 1 Vue{}
					// console.log(document.getElementsByTagName('button')); // 与 1 一样
					// this.handle(); // 正常
				},



				// beforeMount还没有挂载
				// 不能获取真实DOM元素
				beforeMount() {
					console.log("\n------------------- 挂载前阶段：beforeMount -------------------");
					console.log(this.count, this.$refs.cur, this);  // 1 undefined Vue{}
					this.print();  // 正常
					this.count++;  // 正常
					console.log(this.count, this.$refs.cur, this);  // 2 undefined Vue{}

				},
				// 挂载完毕，真实DOM元素也渲染完毕
				// 在项目中，也可以发送ajax请求   
				mounted() {
					console.log("\n------------------- 挂载阶段：mounted -------------------");
					console.log(this.count, this.$refs.cur, this);  // 2 <span>​2​</span>​ Vue{}
					// 可以获取DOM元素
					this.print();  // 正常
					this.count++;  // 正常
					console.log(this.count, this.$refs.cur, this);  // 3 <span>​2​</span>​ Vue{}
				},



				// 更新之前
				beforeUpdate() {
					console.log("\n------------------- 更新前阶段：beforeUpdate -------------------");
					// this.that = this;
					// this.count++;  // 不死循环
					console.log(this.count, this.$refs.cur, this); // 3 <span>​3​</span>​​ Vue{}
				},
				updated() {
					console.log("\n------------------- 更新阶段：updated -------------------");
					// console.log(this.that === this);  // true
					// this.count++;  // 死循环
					console.log(this.count, this.$refs.cur, this); // 3 <span>​3​</span>​​ Vue{}
				},



				// 销毁之前
				beforeDestroy() {
					console.log("\n------------------- 销毁前阶段：beforeDestroy -------------------");
					this.count++;
					this.print(); // 正常
					console.log(this.count, this);  // 4​​ Vue{}
				},
				destroyed() {
					console.log("\n------------------- 销毁阶段：destroyed -------------------");
					this.print(); // 正常
					this.count++; // beforeDestroy 4   // destroyed 5 不会触发updated
					console.log(this.count, this);  // 5​​ Vue{}
					
					setTimeout(() => {
						console.log("\n------------------- 销毁延时：destroyed -------------------");
						this.print(); // 正常
						console.log(this.count, this);  // 5​​ Vue{}
					}, 1000);
				}
			});
			// 总结：
			//   1）初始化阶段： beforeCreate   created  只会执行一次
			//   2）挂载阶段： beforeMount   mounted  只会执行一次
			//   3）更新阶段： beforeUpdate   updated  响应式数据变了，就执行
			//   4）销毁阶段： beforeDestroy   destroyed
			//      所谓的销毁是指vm不工作了，不是指界面看不见
		</script>
	</body>

</html>
