<!DOCTYPE html>
<html>
	<head>
		<script src="https://cdn.staticfile.org/vue/2.2.2/vue.min.js"></script>
		<script src="https://cdn.bootcss.com/vuex/3.0.1/vuex.min.js"></script>
	</head>
	<body>
		<div id="app">
			<h1>{{header}}</h1>
			<h2>{{welcome}}</h2>
			<h3>{{counter}}</h3>
			<button @click="increment">Press Me</button>
		</div>
		<script>
			const store = new Vuex.Store({
				state: {
					msg: 'Hello World',
					count: 0
				},
				//同步执行
				//   mutations相当于其它语言的set,即赋值
				mutations: {
					increment(state, payload) {
						state.count += payload;
					}
				},
				//异步执行，异步：访问服务器后等待响应。
				//actions,相当于其它语言的set，即赋值
				actions: {
					increment(context, payload) {
						//setTimeout:模拟服务器调用且延迟2秒。
						setTimeout(() => {
							context.commit('increment', payload); //调用mutations中的increment()方法 
						}, 1000);
					}
				},
				//get属性，所有组件通过get获取值可以得到表现一致的内容
				getters: {
					msg(state) {
						return state.msg.toUpperCase();
					},
					count(state) {
						return state.count;
					}
				},

			});
			var app = new Vue({
				el: '#app',
				data() {
					return {
						header: 'Vuex App'
					}
				},
				computed: {
					welcome() {
						return store.getters.msg //得到setters属性中的值
					},
					counter() {
						return store.getters.count;
					}
				},
				methods: {
					increment() {
						//store.commit('increment',10) //直接调用mutations中的ncrement()同步方法
						store.dispatch('increment', 10) //调用actions中的increment()异步方法
					}
				}
			});
		</script>
	</body>
</html>
