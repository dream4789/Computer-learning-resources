<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<title>宝贵的一票</title>
		<script src="./jquery.min.js"></script>
		<link rel="stylesheet" href="./bootstrap.min.css" />
		<link rel="stylesheet" href="./style.css" />
	</head>

	<body>
		<div class="inner-container shadow">
			<div class="mb-3 row">
				<label class="col-sm-2 col-form-label">投票主题</label>
				<div class="col-sm-9">
					<input type="text" class="form-control" />
				</div>
			</div>
			<div class="list">

			</div>
			<div class="add">
				<div class="addtxt">
					<img src="./plus-square.svg" alt="加号图标" />
					添加选项
				</div>
			</div>
			<div class="form-check checkbox-one">
				<input class="form-check-input" type="checkbox" value="" />
				<label class="form-check-label" for="flexCheckDefault">
					支持多选
				</label>
			</div>
			<div class="form-check">
				<input class="form-check-input" type="checkbox" value="" />
				<label class="form-check-label" for="flexCheckDefault">
					公开投票结果
				</label>
			</div>

			<div class="row bottom">
				<div class="col">
					<a class="historytxt" href="javascript:void(0)">历史投票</a>
				</div>
				<div class="col"></div>
				<div class="col">
					<button type="button" class="btn btn-light">取消</button>
					<button type="button" class="btn btn-primary">发起投票</button>
				</div>
			</div>
		</div>

		<script>
			let initRender = (txt) => {
				return `<div class="mb-3 row">
                <label class="col-sm-2 col-form-label txt">${txt}</label>
                <div class="col-sm-9">
                    <input type="text" class="form-control">
               </div>
            </div>`;
			};
			$((function() {
				// 初始化的时候渲染两条数据，且不带删除符号
				for (let index = 0; index < 2; index++) {
					let initList = initRender(`选项${index + 1}`);
					$(".list").append(initList);
				}

				// 点击加号逻辑
				$(".add").click(function() {
					// TODO 待补充代码
					let listlen = $(".list").children().length; // list 下子元素的个数
					if (listlen === 2) {
						$(".list").children().each((index, item) => {
							$(item).append(`
			                <div class="col-sm-1">
								<img class="del-icon" src="./images/x.svg" alt="" />
							</div>`)
						});
					}
					
					if (listlen < 2) {
						$(".list").append(initRender(`选项${listlen + 1}`));
					} else {
						$(".list").append(`
						<div class="mb-3 row item">
					        <label class="col-sm-2 col-form-label txt">选项${listlen + 1}</label>
							<div class="col-sm-9">
								<input type="text" class="form-control" />
							</div>
							<!-- 删除图标 del-icon -->
							<div class="col-sm-1">
								<img class="del-icon" src="./x.svg" alt="" />
							</div>
					    </div>`);
					}
				});
				// $(".form-check-input").parent().remove();
				
				// 点击 x 删除逻辑，列表小于 2 项时不显示删除图标
				$(document).on("click", ".del-icon", function() { // 作用在del-icon上的点击事件
					// TODO 待补充代码
					// console.log($(this).parent().parent());
					$(this).parent().parent().remove();
					$(".list").children().each((index, item) => {
						$(item).children('label').text(`选项${index + 1}`)
						if ($(".list").children().length <= 2) {
							$(item).children()[2].remove()
						}
					})
				});
			})());
		</script>
	</body>
</html>
