(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{"/OR3":function(t,e,n){"use strict";n.d(e,"a",function(){return f});var o=n("MVZn"),r=n.n(o),c=n("lSNA"),i=n.n(c),a=n("fLKj"),u=n("X3bR"),s=n("G2yP"),d=n("vJeY"),l=n("r6IF"),f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){var o=t;return n(Object(u.a)({mpQrCode:i()({},o,!1)})),n(Object(u.a)({mpQrCode:i()({},o,!1)})),Object(d.e)("getMPQrCode/".concat(t),a.a.bind(void 0,{scene:t,data:r()({},e,{page:"pages/work"})})).then(function(t){return n(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{payload:{key:t.key,data:t.data,contentType:t.contentType},type:l.db}}(r()({key:o},t))),n(Object(u.a)({mpQrCode:i()({},o,!1)})),t}).catch(function(t){n(Object(u.a)({mpQrCode:i()({},o,!1)})),n(Object(s.b)({mpQrCode:i()({},o,t)}))})}}},"1ZyL":function(t,e,n){"use strict";n.d(e,"h",function(){return v}),n.d(e,"g",function(){return p}),n.d(e,"k",function(){return y}),n.d(e,"d",function(){return k}),n.d(e,"f",function(){return w}),n.d(e,"b",function(){return I}),n.d(e,"c",function(){return P}),n.d(e,"e",function(){return S}),n.d(e,"j",function(){return _}),n.d(e,"i",function(){return T}),n.d(e,"a",function(){return N});var o=n("lSNA"),r=n.n(o),c=n("vJeY"),i=n("X3bR"),a=n("G2yP"),u=n("x00z"),s=n("WzQc"),d=n("lqrD"),l=n("r6IF"),f=n("oBTp"),b=n("yxO2"),g=n("wgvv"),v=function(){return{payload:{key:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).key},type:l.C}},p=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:l.Bb}},h=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:l.mc}},O=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:l.ic}},j=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:l.gc}},m=function(t){return function(){var e=t.getAPITypes(),n=t.getSlug();Object(c.e)("[ignore]updateWorkViews",u.R.bind(void 0,{type:e,slug:n})).then(function(){})}},y=function(t){return function(e){t&&!t.isLiked()&&e(m(t))}},k=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){var o=t.getKey();n(Object(i.a)({work:r()({},o,!0)})),n(Object(a.b)({work:r()({},o,null)}));var s=u.n;return t.isPhoto360()?s=u.k:t.isPhoto()&&(s=u.j),Object(c.d)("getWork/".concat(o),s.bind(void 0,{slug:t.getSlug()})).then(function(t){n(p({key:o,data:t.item})),n(Object(i.a)({work:r()({},o,!1)})),e&&n(m(new b.b(t.item)))}).catch(function(t){n(Object(i.a)({work:r()({},o,!1)})),n(Object(a.b)({work:r()({},o,t)}))})}},w=function(t){return function(e,n){if(!n().getIn(["account","account"]).isLoggedIn())return e(Object(d.h)({authFormType:"SIGN_IN"})),Promise.resolve();var o=t.getKey(),a=t.isLiked();e(h({key:o,liked:!a}));var s=a?u.K:u.r;return t.isVideo()?s=a?u.N:u.u:t.isPhoto360()?s=a?u.L:u.s:t.isStory()&&(s=a?u.M:u.t),e(Object(i.a)({like:r()({},o,!0)})),Object(c.e)("likeWork/".concat(o),s.bind(void 0,{slug:t.getSlug()})).then(function(){e(Object(i.a)({like:r()({},o,!1)}))}).catch(function(t){e(Object(i.a)({like:r()({},o,!1)})),t.getCode&&401!==t.getCode()&&!t.isInvalidCSRF()||e(h({key:o,liked:a}))})}},I=function(t){return function(e,n){if(!n().getIn(["account","account"]).isLoggedIn())return e(Object(d.h)({authFormType:"SIGN_IN"})),Promise.resolve();var o=t.getKey(),a=t.isFavorited();e(O({key:o,favorited:!a}));var s=a?u.H:u.d;return t.isVideo()?s=a?u.J:u.f:t.isPhoto360()&&(s=a?u.I:u.e),e(Object(i.a)({favorite:r()({},o,!0)})),Object(c.e)("favoriteWork/".concat(o),s.bind(void 0,{slug:t.getSlug()})).then(function(){e(Object(i.a)({favorite:r()({},o,!1)}))}).catch(function(t){e(Object(i.a)({favorite:r()({},o,!1)})),t.getCode&&401!==t.getCode()&&!t.isInvalidCSRF()||e(O({key:o,favorited:a}))})}},P=function(t){return function(e,n){if(!n().getIn(["account","account"]).isLoggedIn())return e(Object(d.h)({authFormType:"SIGN_IN"})),Promise.resolve();var o=t.getAuthor(),a=o.getSlug(),u=o.isFollowed();if(!a)return Promise.resolve();var l=t.getKey();e(j({key:l,followed:!u}));var f=u?s.f:s.a;return e(Object(i.a)({follow:r()({},a,!0)})),Object(c.e)("follow/".concat(a),f.bind(void 0,{slug:a})).then(function(){e(Object(i.a)({follow:r()({},a,!1)}))}).catch(function(t){e(Object(i.a)({follow:r()({},a,!1)})),t.getCode&&401!==t.getCode()&&!t.isInvalidCSRF()||e(j({key:l,followed:u}))})}},S=function(t){return function(e){var n,o=t.getKey(),i=t.getSlug();return n=t.isVideo()?u.q:t.isPhoto360()?u.o:u.p,e(Object(a.b)({workUpdate:r()({},o,null)})),Object(c.e)("updateInit/".concat(o),n.bind(void 0,{slug:i})).then(function(t){var n=t.item.token;e(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{payload:{key:t.key,token:t.token},type:l.nc}}({key:o,token:n}))}).catch(function(t){e(Object(a.b)({workUpdate:r()({},o,t)}))})}},_=function(t){return function(e,n){if(!n().getIn(["account","account"]).isLoggedIn())return e(Object(d.h)({authFormType:"SIGN_IN"})),Promise.resolve();var o,s=t.getSlug(),l=t.getKey(),b=t.getUpdateToken();return b?(e(Object(i.a)({workUpdate:r()({},l,!0)})),e(Object(a.b)({workUpdate:r()({},l,null)})),o=t.isVideo()?u.Q:t.isPhoto360()?u.P:u.O,Object(c.e)("update/".concat(l),o.bind(void 0,{slug:s,token:b,data:t.getUpdateData()})).then(function(){n().getIn(["upload","joinContest"])&&e(Object(g.n)(t)).then(function(t){Object(g.m)(t)}).catch(function(t){return Object(g.m)(t)}),e(Object(i.a)({workUpdate:r()({},l,!1)})),e(Object(f.c)(t.getUrl()))}).catch(function(t){e(Object(i.a)({workUpdate:r()({},l,!1)})),e(Object(a.b)({workUpdate:r()({},l,t)}))})):Promise.resolve()}},T=function(t,e){return function(n,o){if(!o().getIn(["account","account"]).isLoggedIn())return n(Object(d.h)({authFormType:"SIGN_IN"})),Promise.resolve();var s=t.getKey(),l=t.getSlug(),f=u.E;return t.isVideo()?f=u.G:t.isPhoto360()&&(f=u.F),n(Object(i.a)({workShare:r()({},s,!0)})),n(Object(a.b)({workShare:r()({},s,null)})),Object(c.e)("share/".concat(l),f.bind(void 0,{slug:l,type:e})).then(function(){n(Object(i.a)({workShare:r()({},s,!1)})),n(Object(a.b)({workShare:r()({},s,null)}))}).catch(function(t){n(Object(i.a)({workShare:r()({},s,!1)})),n(Object(a.b)({workShare:r()({},s,t)}))})}},N=function(t){return function(e,n){if(!n().getIn(["account","account"]).isLoggedIn())return e(Object(d.h)({authFormType:"SIGN_IN"})),Promise.resolve();var o,s=t.getSlug(),l=t.getKey(),b=t.getAuthor();return o=t.isVideo()?u.c:t.isPhoto360()?u.b:u.a,e(Object(i.a)({workDelete:r()({},l,!0)})),e(Object(a.b)({workDelete:r()({},l,null)})),Object(c.e)("delete/".concat(s),o.bind(void 0,{slug:s})).then(function(){e(Object(f.c)(b.getUrl())),e(Object(i.a)({workDelete:r()({},l,!1)})),e(Object(a.b)({workDelete:r()({},l,null)}))}).catch(function(t){e(Object(i.a)({workDelete:r()({},l,!1)})),e(Object(a.b)({workDelete:r()({},l,t)}))})}}},"2oVF":function(t,e,n){"use strict";n.d(e,"q",function(){return k}),n.d(e,"h",function(){return P}),n.d(e,"m",function(){return S}),n.d(e,"i",function(){return _}),n.d(e,"n",function(){return T}),n.d(e,"l",function(){return N}),n.d(e,"d",function(){return A}),n.d(e,"e",function(){return W}),n.d(e,"b",function(){return G}),n.d(e,"k",function(){return M}),n.d(e,"f",function(){return R}),n.d(e,"g",function(){return q}),n.d(e,"o",function(){return D}),n.d(e,"p",function(){return E}),n.d(e,"j",function(){return z}),n.d(e,"c",function(){return K}),n.d(e,"a",function(){return x});var o,r=n("MVZn"),c=n.n(r),i=n("lSNA"),a=n.n(i),u=n("Cfm6"),s=n("WzQc"),d=n("vJeY"),l=n("lqrD"),f=n("KwH0"),b=n("r6IF"),g=n("WlAH"),v=n("X3bR"),p=n("G2yP"),h=n("oBTp"),O=n("W5jJ"),j=n("vaYg"),m=function(t){t&&clearInterval(t)},y=function(t){switch(t){case"likes":case"like":return"likes";case"comments":case"comment":return"comments";case"follows":case"follow":return"follows";case"favorites":case"favorite":return"favorites";case"notices":case"notice":return"systems";case"messages":case"message":return"messages";case"quests":case"quest":return"quests";default:return t}},k=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:b.Vb}},w=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{payload:{key:t.key,items:t.items,id:t.id,type:t.type,isPolling:t.isPolling},type:b.Q}},I=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:b.ib}},P=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:b.p}},S=function(){return function(t,e){e().getIn(["account","account"]).isLoggedIn()?t(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:b.Ob}}()):t(Object(l.h)({authFormType:"SIGN_IN"}))}},_=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:b.q}},T=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:b.Qb}},N=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:b.Hb}},C=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{payload:{key:t.key,message:t.message},type:b.a}},L=function(){return{payload:{user:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).user},type:b.ec}},F=function(){return function(t,e){return e().getIn(["account","account"]).isLoggedIn()?Object(d.d)("getNotificationStats",u.f.bind(void 0,{})).then(function(e){var n=e.items;t(function(){return{payload:{items:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).items},type:b.jb}}({items:void 0===n?[]:n}))}):Promise.resolve()}},U=function(){return function(t,e){return e().getIn(["account","account"]).isLoggedIn()?Object(d.d)("getUnreadCount",u.i.bind(void 0,{})).then(function(e){var n=e.item;t(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:b.wb}}(void 0===n?{}:n))}):Promise.resolve()}},A=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.slug,n=t.id,o=t.limit;return function(t,r){return r().getIn(["account","account"]).isLoggedIn()?(t(Object(v.a)({loadConversation:a()({},e,!0)})),Object(d.d)("getConversations/".concat(e,"/").concat(n,"/").concat(o),u.c.bind(void 0,{slug:e,id:n,limit:o})).then(function(o){var r=o.items,c=void 0===r?[]:r;t(Object(v.a)({loadConversation:a()({},e,!1)})),t(w({key:e,items:c,id:n}))}).catch(function(){t(Object(v.a)({loadConversation:a()({},e,!1)}))})):Promise.resolve()}},W=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.slug,n=t.id;return function(t,o){return o().getIn(["account","account"]).isLoggedIn()?Object(d.d)("getConversationsByPolling/".concat(e,"/").concat(n),u.d.bind(void 0,{slug:e,id:n})).then(function(o){var r=o.items;t(w({key:e,items:void 0===r?[]:r,id:n,isPolling:!0}))}):Promise.resolve()}},G=function(t){return function(e,n){if(!n().getIn(["account","account"]).isLoggedIn())return e(Object(l.h)({authFormType:"SIGN_IN"})),Promise.resolve();var o=t.getSlug(),r=t.isFollowed();if(!o)return Promise.resolve();e(L({user:t}));var c=r?s.f:s.a;return e(Object(v.a)({follow:a()({},o,!0)})),Object(d.e)("follow/".concat(o),c.bind(void 0,{slug:o})).then(function(){e(Object(v.a)({follow:a()({},o,!1)}))}).catch(function(n){e(Object(v.a)({follow:a()({},o,!1)})),n.getCode&&401!==n.getCode()&&!n.isInvalidCSRF()||e(L({user:t}))})}},M=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.slug,n=t.message,o=t.eventName;return function(t,r){return r().getIn(["account","account"]).isLoggedIn()?(t(C({key:e,message:n})),Object(d.e)("sendMessage/".concat(Math.random()),u.m.bind(void 0,{slug:e,content:n.getContent()})).then(function(){o&&Object(f.f)({event:o,pageGroup:"User Profile Page",isSuccess:!0,accountId:e})}).catch(function(n){var r=n.getMessage?n.getMessage():"";O.a.error(r);var c=new Date;t(C({key:e,message:new j.a({id:"".concat(c,"-warning"),content:r,created_at:c,from:"warning"})})),o&&Object(f.f)({event:o,pageGroup:"User Profile Page",isSuccess:!1,reason:r,accountId:e})})):(t(Object(l.h)({authFormType:"SIGN_IN"})),Promise.resolve())}},R=function(t){var e=t.type,n=t.page,o=t.pageSize,r=t.singlePage,i=void 0!==r&&r,s=t.enableLoading,f=void 0===s||s,g=t.readMessage,j=void 0!==g&&g;return function(t,r){var s=r().getIn(["account","account"]);if(!s.isLoggedIn())return t(Object(l.h)({authFormType:"SIGN_IN"})),Promise.resolve();if("messages"===e&&t(function(t,e){if(!e().getIn(["account","account"]).isLoggedIn())return t(Object(l.h)({authFormType:"SIGN_IN"})),Promise.resolve();var n="latestAdminNotice";return t(Object(v.a)({messages:a()({},n,!0)})),t(Object(p.b)({messages:a()({},n,null)})),Object(d.d)("getNotifications/".concat(n),u.e.bind(void 0,{})).then(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).item,o=void 0===e?{}:e;t(Object(v.a)({messages:a()({},n,!1)})),t(Object(p.b)({messages:a()({},n,null)})),t(I({key:n,items:[o]}))}).catch(function(e){e.getCode&&404===e.getCode()||O.a.error(e.getMessage?e.getMessage():""),t(Object(v.a)({messages:a()({},n,!1)})),t(Object(p.b)({messages:a()({},n,e)}))})}),"quests"===e&&s.isFromApi()&&!s.isContractedPhotographer())return Promise.resolve();var g=y(e),m=0===n?1:(n||r().getIn(["messages",e,"page"])||0)+1;return f&&t(Object(v.a)({messages:a()({},e,!0)})),t(Object(p.b)({messages:a()({},e,null)})),Object(d.d)("getNotifications/".concat(g),u.g.bind(void 0,c()({type:g},Object(h.a)(m,o)))).then(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=r.items,s=void 0===c?[]:c,f=r.total_items;t(Object(v.a)({messages:a()({},e,!1)})),t(Object(p.b)({messages:a()({},e,null)})),t("quests"===e?function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:b.lb}}({key:e,items:s,totalItems:f,page:m,pageSize:o,singlePage:i}):I({key:e,items:s,totalItems:f,page:m,pageSize:o,singlePage:i})),"messages"!==g&&0===n&&j&&"quests"!==g&&t(function(){var t=this,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type;return function(n,o){if(o().getIn(["account","account"]).isLoggedIn()){var r=y(e);Object(d.e)("readAllMessages/".concat(r),u.l.bind(t,{type:r})).then(function(){n(q({stats:!0}))})}else n(Object(l.h)({authFormType:"SIGN_IN"}))}}({type:e}))}).catch(function(n){O.a.error(n.getMessage?n.getMessage():""),t(Object(v.a)({messages:a()({},e,!1)})),t(Object(p.b)({messages:a()({},e,n)}))})}},q=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.unreadCount,n=void 0!==e&&e,o=t.stats,r=void 0!==o&&o,c=t.messages,i=void 0!==c&&c,a=t.enableLoading,u=void 0!==a&&a,s=t.readMessage;return function(t,e){var o=e().getIn(["messages","loopSwitch"]);if((o.get("unreadCount")||n)&&t(U()),(o.get("stats")||r)&&t(F()),o.get("messages")||i){var c=e().getIn(["messages","messages","page"])||1,a=e().getIn(["messages","messages","pageSize"]);t(R({type:"messages",page:c-1,pageSize:a,singlePage:!g.IS_MOBILE,enableLoading:u,readMessage:s}))}}},D=function(){return function(t){t(function(t){m(o),o=setInterval(function(){t(q())},g.REQUEST_MESSAGE_TIMEOUT)})}},E=function(){return function(){m(o)}};var z=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.user,n=t.isAdmin;return function(t,o){if(!o().getIn(["account","account"]).isLoggedIn())return t(Object(l.h)({authFormType:"SIGN_IN"})),Promise.resolve();var r=e.getSlug(),c=n?u.j:u.k,i=n?{}:{userSlug:r};return Object(d.e)("readAllConversations/".concat(r),c.bind(void 0,i)).then(function(){n||t(function(){return{payload:{user:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).user},type:b.Lb}}({user:e})),t(q({stats:!0}))})}},K=function(t){return function(e,n){if(!n().getIn(["account","account"]).isLoggedIn())return e(Object(l.h)({authFormType:"SIGN_IN"})),Promise.resolve();var o=t.getSlug(),r="adminNotices";return e(Object(v.a)({messages:a()({},r,!0)})),e(Object(p.b)({messages:a()({},r,null)})),Object(d.d)("getNotifications/".concat(r),u.b.bind(void 0,{})).then(function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).items,n=void 0===t?[]:t;e(Object(v.a)({messages:a()({},r,!1)})),e(Object(p.b)({messages:a()({},r,null)})),e(w({key:o,items:n,type:r}))}).catch(function(t){O.a.error(t.getMessage?t.getMessage():""),e(Object(v.a)({messages:a()({},r,!1)})),e(Object(p.b)({messages:a()({},r,t)}))})}},x=function(t){return function(e){return e(Object(v.a)({completeQuest:a()({},t,!0)})),e(Object(p.b)({completeQuest:a()({},t,null)})),Object(d.e)("completeQuest/".concat(t),u.a.bind(void 0,{questSlug:t})).then(function(){e(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:b.k}}({questSlug:t})),e(Object(v.a)({completeQuest:a()({},t,!1)}))}).catch(function(n){e(Object(v.a)({completeQuest:a()({},t,!1)})),e(Object(p.b)({completeQuest:a()({},t,n)}))})}}},"7vQM":function(t,e,n){"use strict";n.d(e,"a",function(){return N}),n.d(e,"j",function(){return C}),n.d(e,"e",function(){return F}),n.d(e,"g",function(){return U}),n.d(e,"f",function(){return A}),n.d(e,"b",function(){return W}),n.d(e,"c",function(){return M}),n.d(e,"d",function(){return R}),n.d(e,"i",function(){return q}),n.d(e,"h",function(){return D}),n.d(e,"k",function(){return E});var o=n("RIqP"),r=n.n(o),c=n("MVZn"),i=n.n(c),a=n("lSNA"),u=n.n(a),s=n("BAbe"),d=n.n(s),l=n("vJeY"),f=n("X3bR"),b=n("G2yP"),g=n("3eXy"),v=n("PnDU"),p=n("oBTp"),h=n("x00z"),O=n("jxVO"),j=n("lqrD"),m=n("7/Lq"),y=n("fjhF"),k=n("7Qib"),w=n("r6IF"),I=n("1ZyL"),P=n("5jSc"),S=n("+/mN"),_=void 0,T=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:w.zb}},N=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:w.j}},C=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=t.url,o=t.params;return function(t){return Object(l.d)(e,g.b.bind(_,{url:n,params:o})).then(function(n){var o=n.items;t(T({key:e,items:o}))})}},L=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{payload:{keys:t.keys,work:t.work},type:w.kc}},F=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.page,n=t.pageSize;return function(t,o){var r="follows";t(Object(f.a)(u()({},r,!0))),t(Object(b.b)(u()({},r,null)));var c=e||(o().getIn(["works",r,"page"])||0)+1;return Object(l.d)("getFollows/".concat(c,"/").concat(n),v.a.bind(_,i()({},Object(p.a)(c,n)))).then(function(e){var n=e.items;t(T({key:r,items:n,page:c})),t(Object(f.a)(u()({},r,!1)))}).catch(function(e){t(Object(f.a)(u()({},r,!1))),t(Object(b.b)(u()({},r,e)))})}},U=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.resourceType,n=void 0===e?P.a:e,o=t.topic,r=t.sort,c=void 0===r?S.a:r,a=t.filters,s=t.page,d=t.pageSize,g=void 0===d?20:d;return function(t,e){var r="".concat(o.getReducerKey(),"/").concat(n),d=o.getSlug(),v=Object(l.b)(a);t(Object(f.a)(u()({},r,!0))),t(Object(b.b)(u()({},r,null)));var O,j=s||(e().getIn(["works",r,"page"])||0)+1;return n===P.a?O=h.D:n===P.d?O=h.C:n===P.b?O=h.B:n===P.c&&(O=h.A),"creator_works"===d&&(O=h.g),Object(l.d)("getTopicWorks/".concat(d),O.bind(_,i()({sort:c,slug:d,filter:v},Object(p.a)(j,g)))).then(function(e){var n=e.items;t(T({key:r,items:n,page:j})),t(Object(f.a)(u()({},r,!1)))}).catch(function(e){t(Object(f.a)(u()({},r,!1))),t(Object(b.b)(u()({},r,e)))})}},A=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.resourceType,n=void 0===e?P.a:e,o=t.tag,r=t.sort,c=void 0===r?S.a:r,a=t.filters,s=t.page,d=t.pageSize;return function(t,e){var r,g="".concat(o.getReducerKey(),"/").concat(n,"/").concat(c),v=o.getSlug(),O=Object(l.b)(a),j=s||(e().getIn(["works",g,"page"])||0)+1;return t(Object(f.a)(u()({},g,!0))),t(Object(b.b)(u()({},g,null))),n===P.a?r=h.z:n===P.d?r=h.y:n===P.b?r=h.x:n===P.c&&(r=h.w),Object(l.d)("getTagWorks/".concat(v),r.bind(_,i()({sort:Object(k.p)(c)?"popular":c,cycle:Object(k.m)(c),slug:v,filter:O},Object(p.a)(j,d)))).then(function(e){var n=e.items;t(T({key:g,items:n,page:j})),t(Object(f.a)(u()({},g,!1)))}).catch(function(e){t(Object(f.a)(u()({},g,!1))),t(Object(b.b)(u()({},g,e)))})}},W=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.sort,n=void 0===e?"hot":e,o=t.filters,r=t.page,c=t.pageSize,a=void 0===c?20:c;return function(t,e){var c="WORKS:all",s=Object(l.b)(o);t(Object(f.a)(u()({},c,!0))),t(Object(b.b)({work:u()({},c,null)}));var d=r||(e().getIn(["works",c,"page"])||0)+1;return Object(l.d)("getAllWorks/".concat(d,"/").concat(a,"/").concat(n,"/").concat(s),h.v.bind(_,i()({sort:n,filter:s},Object(p.a)(d,a)))).then(function(e){var n=e.items;t(T({key:c,items:n,page:d,pageSize:a})),t(Object(f.a)(u()({},c,!1)))}).catch(function(e){t(Object(f.a)(u()({},c,!1))),t(Object(b.b)({work:u()({},c,e)}))})}},G=null,M=function(t){var e=t.work,n=t.page,o=void 0===n?1:n;return function(t){var n=e.getKey(),c=m.a.YOU_MAY_ALSO_LIKE,i=G?Promise.resolve(G):Object(l.d)("getBanners/".concat(c),O.a.bind(_,{bannerType:c})).then(function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).items,e=void 0===t?[]:t;if(e[0]){var n=Object(y.d)(e[0].link_url),o=n.type,r=n.slug;if(o&&r){var c="videos"===o?h.n:h.j;return Object(l.d)("getWork/".concat(r),c.bind(_,{slug:r})).then(function(t){return[t.item]}).catch(function(){return[]})}}return[]}).then(function(t){return G=t,t}),a=Object(l.d)("alsoLikeFeed",g.b.bind(_,{url:"/v2/mobile/feeds",params:{limit:20,offset:20*Math.floor(50*Math.random())}})).then(function(t){var e=t.items;return d()(e,6)}).catch(function(){return[]});return Promise.all([i,a]).then(function(e){var c;t(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:w.E}}({key:n,items:(c=[]).concat.apply(c,r()(e)),page:o,pageSize:6}))})}},R=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).slug;return function(e){var n="editors/".concat(t);return e(Object(f.a)({work:u()({},n,!0)})),e(Object(b.b)({work:u()({},n,null)})),Object(l.d)(n,h.h.bind(_,{slug:t})).then(function(t){var o=t.item;e(Object(f.a)({work:u()({},n,!1)})),e(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:w.S}}({key:n,items:o.works,title:o.title,subtitle:o.sub_title}))}).catch(function(t){e(Object(f.a)({work:u()({},n,!1)})),e(Object(b.b)({work:u()({},n,t)}))})}},q=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.user,n=t.pageSize,o=void 0===n?20:n,r=t.isInit,c=void 0!==r&&r,i=t.filterType;return function(t,n){var r=e.getSlug(),a=r,s=c?0:n().getIn(["works",a,"nextOffset"])||0;return t(Object(f.a)({work:u()({},a,!0)})),t(Object(b.b)({work:u()({},a,null)})),Object(l.d)("getUserWorks/".concat(r,"/").concat(i,"/").concat(s,"/").concat(o),h.m.bind(_,{slug:r,limit:o,offset:s,filter_type:i})).then(function(e){t(T({key:a,items:e.items,page:0===s?1:2,nextOffset:e.next_offset,pageSize:o})),t(Object(f.a)({work:u()({},a,!1)}))}).catch(function(e){t(Object(f.a)({work:u()({},a,!1)})),t(Object(b.b)({work:u()({},a,e)}))})}},D=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.user,n=t.pageSize,o=void 0===n?20:n,r=t.page;return function(t,n){var c=e.getSlug(),a="".concat(c,"/favorites"),s=r||(n().getIn(["works",a,"page"])||0)+1;return t(Object(f.a)({work:u()({},a,!0)})),t(Object(b.b)({work:u()({},a,null)})),Object(l.d)("getUserFavoriteWorks/".concat(c,"/").concat(s,"/").concat(o),h.l.bind(_,i()({slug:c},Object(p.a)(s,o)))).then(function(e){var n=e.items;t(T({key:a,items:n,page:s,pageSize:o})),t(Object(f.a)({work:u()({},a,!1)}))}).catch(function(e){t(Object(f.a)({work:u()({},a,!1)})),t(Object(b.b)({work:u()({},a,e)}))})}},E=function(t){var e=t.keys,n=t.work;return function(t,o){if(!o().getIn(["account","account"]).isLoggedIn())return t(Object(j.h)({authFormType:"SIGN_IN"})),Promise.resolve();var r=n.isLiked(),c=n.getKey();t(L({keys:e,work:n.setIsLiked(!r)}));var i=r?h.K:h.r;return n.isVideo()?i=r?h.N:h.u:n.isPhoto360()?i=r?h.L:h.s:n.isStory()&&(i=r?h.M:h.t),t(Object(f.a)({like:u()({},c,!0)})),Object(l.e)("likeWork/".concat(c),i.bind(_,{slug:n.getSlug()})).then(function(){t(Object(f.a)({like:u()({},c,!1)})),n.isStory()||t(Object(I.k)(n))}).catch(function(o){t(Object(f.a)({like:u()({},c,!1)})),o.getCode&&401!==o.getCode()&&!o.isInvalidCSRF()||t(L({keys:e,work:n.setIsLiked(r)}))})}}},DQVl:function(t,e,n){"use strict";n.d(e,"d",function(){return r}),n.d(e,"a",function(){return c}),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return a});var o=n("r6IF"),r=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:o.ac}},c=function(){return{type:o.h}},i=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:o.Kb}},a=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:o.Mb}}},G2yP:function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return a});var o=n("lSNA"),r=n.n(o),c=n("r6IF"),i=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:c.Ib}},a=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).key;return function(e){e(i(r()({},t,null)))}}},JoKX:function(t,e,n){"use strict";n.d(e,"a",function(){return p}),n.d(e,"g",function(){return h}),n.d(e,"f",function(){return O}),n.d(e,"c",function(){return j}),n.d(e,"d",function(){return m}),n.d(e,"b",function(){return y}),n.d(e,"h",function(){return k}),n.d(e,"e",function(){return w});var o=n("MVZn"),r=n.n(o),c=n("lSNA"),i=n.n(c),a=n("vJeY"),u=n("3eXy"),s=n("X3bR"),d=n("G2yP"),l=n("mj9/"),f=n("oBTp"),b=n("7vQM"),g=n("r6IF"),v=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:g.pb}},p=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:g.e}},h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=void 0===e?"/v2/tags?{}":e,o=t.url,r=void 0===o?"/v2/tags":o,c=t.params,i=t.fetchTagData;return function(t){return Object(a.d)(n,u.b.bind(void 0,{url:r,params:c})).then(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).items;t(v({key:n,items:e})),i&&t(function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).key;return function(e,n){n().getIn(["tags",t]).forEach(function(t){e(Object(b.j)({key:t.getUrl(),url:t.getWorksUrl(),params:{limit:16,offset:0}}))})}}({key:n}))})}},O=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).params;return function(e){var n="/locations";return Object(a.d)(n,l.f.bind(void 0,{params:t})).then(function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).items;e(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:g.qb}}({key:n,items:t}))})}},j=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).params;return function(e){var n="/hotLocations";return Object(a.d)(n,l.c.bind(void 0,{params:t})).then(function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).items;e(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:g.bb}}({key:n,items:t}))})}},m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=void 0===e?"recomendTags":e,o=t.params;return function(t){return Object(a.d)(n,l.d.bind(void 0,{params:o})).then(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).items;t(v({key:n,items:e}))})}},y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=void 0===e?"associativeTags":e,o=t.keyword,c=t.page,u=t.pageSize,b=void 0===u?10:u;return function(t,e){var u=c||(e().getIn(["tags",n,"page"])||0)+1;return t(Object(s.a)({tags:i()({},n,!0)})),t(Object(d.b)({tags:i()({},n,null)})),Object(a.d)(n,l.b.bind(void 0,r()({keyword:o},Object(f.a)(u,b)))).then(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).items;t(Object(s.a)({tags:i()({},n,!1)})),t(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:g.I}}({key:n,items:e,page:u}))}).catch(function(e){t(Object(s.a)({tags:i()({},n,!1)})),t(Object(d.b)({tags:i()({},n,e)}))})}},k=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.group,n=t.page,o=t.pageSize,c=void 0===o?9:o;return function(t,o){var u="group-".concat(e),b=n||(o().getIn(["tags",u,"page"])||0)+1;return t(Object(s.a)({tags:i()({},u,!0)})),t(Object(d.b)({tags:i()({},u,null)})),Object(a.d)(u,l.g.bind(void 0,r()({group:e},Object(f.a)(b,c)))).then(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).items;t(Object(s.a)({tags:i()({},u,!1)})),t(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:g.ob}}({key:u,items:e,page:b}))}).catch(function(e){t(Object(s.a)({tags:i()({},u,!1)})),t(Object(d.b)({tags:i()({},u,e)}))})}},w=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).slug;return function(e){return e(Object(s.a)({tags:i()({},t,!0)})),Object(a.d)(t,l.a.bind(void 0,{slug:t})).then(function(){var n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).item;e(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:g.sb}}({item:n})),e(Object(s.a)({tags:i()({},t,!1)}))}).catch(function(n){e(Object(s.a)({tags:i()({},t,!1)})),e(Object(d.b)({tags:i()({},t,n)}))})}}},KwH0:function(t,e,n){"use strict";n.d(e,"h",function(){return f}),n.d(e,"i",function(){return b}),n.d(e,"f",function(){return g}),n.d(e,"d",function(){return v}),n.d(e,"g",function(){return p}),n.d(e,"a",function(){return h});var o=n("MVZn"),r=n.n(o),c=n("vDqi"),i=n.n(c),a=n("qyjI"),u=n.n(a),s=n("WlAH"),d=n("1uN/");n.d(e,"c",function(){return d.g}),n.d(e,"b",function(){return d.f}),n.d(e,"e",function(){return d.h});n("Uu2M"),n("puT/");var l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.e;return{method:"POST",headers:{appid:d.b,"content-type":"application/json",sign:u()(JSON.stringify(t),d.c||"")},data:t,baseURL:d.d,url:e}},f=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3?arguments[3]:void 0,r=(arguments.length>4&&void 0!==arguments[4]&&arguments[4],function(t){return l(t)}([{type:"event",category:t,action:e,label:n,value:o,flavor:d.a}]));return i()(r).catch(function(){})},b=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};return function(c,i){return f(t,e,n,o,i,r)}},g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};window.dataLayer&&!window.userCookieRequiredOnly&&window.dataLayer.push(r()({platform:s.PLATFORM},t))},v=function(){var t=window.location.pathname;return"/"===t||"/settings/account"===t?"Home Page":t.startsWith("/topics")&&"pc"===s.PLATFORM||t.startsWith("/explore")?"Explore Page":t.startsWith("/tags")||t.startsWith("/topics")&&"m"===s.PLATFORM?"Tags Page":t.startsWith("/photographers")?"Phtographers Page":t.startsWith("/creators")?"Creators Page":t.startsWith("/photos")||t.startsWith("/videos")||t.startsWith("/photo360s")?"Thread Detail Page":t.startsWith("/search")?"Search Result Page":t.startsWith("/login")?"Login Page":t.startsWith("/signup")?"SignUp Page":t.startsWith("/users")?"User Profile Page":t.startsWith("/notifications")?"Notifications Page":t.startsWith("/product-experience-office")?"Activity Page":t.startsWith("/activities_center")||t.startsWith("/officer_aggregation")?"Activities Page":t.startsWith("/contests")?"Anniversary-Contest Page":""},p=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.location.href;return function(o,r){if(!t.startsWith("/photos/play")){var c=[{type:"pageview",page:t,flavor:d.a}],a=l(c);i()(a).catch(function(){});var u=r().getIn(["account","account"]),s=r().getIn(["helmet","previousLocation"]),f=e||r().getIn(["helmet","originLocation"]),b={event:"page_view",userId:u.isLoggedIn()?u.getSlug():void 0,pageTitle:document.title,pageReferer:s?"".concat(window.location.protocol,"//").concat(window.location.host).concat(s.pathname||"").concat(s.search||""):document.referer,originLocation:f,pagePath:t,pageLocation:n};return g(b)}}},h="8th-Anniversary-Video-Contest"},TTTN:function(t,e,n){"use strict";n.d(e,"b",function(){return c}),n.d(e,"c",function(){return i}),n.d(e,"a",function(){return a});var o=n("r6IF"),r=n("oBTp"),c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e){var n=t.currentWork;n&&n.isStory()?e(Object(r.b)(n.getUrl())):e(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:o.Tb}}(t))}},i=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:o.hc}},a=function(){return{type:o.t}}},X3bR:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n("r6IF"),r=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:o.Jb}}},XBlT:function(t,e,n){"use strict";n.d(e,"a",function(){return d});var o=n("lSNA"),r=n.n(o),c=n("jxVO"),i=n("vJeY"),a=n("X3bR"),u=n("G2yP"),s=n("r6IF"),d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.bannerType,n=t.slug;return function(t){return t(Object(a.a)({banners:r()({},e,!0)})),t(Object(u.b)({banners:r()({},e,null)})),Object(i.d)("getBanners/".concat(e),c.a.bind(void 0,{bannerType:e,slug:n})).then(function(n){t(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:s.K}}({key:e,data:n})),t(Object(a.a)({banners:r()({},e,!1)}))}).catch(function(n){t(Object(a.a)({banners:r()({},e,!1)})),t(Object(u.b)({banners:r()({},e,n)}))})}}},eUfH:function(t,e,n){"use strict";n.d(e,"a",function(){return l}),n.d(e,"d",function(){return f}),n.d(e,"c",function(){return b}),n.d(e,"b",function(){return g});var o=n("lSNA"),r=n.n(o),c=n("vJeY"),i=n("X3bR"),a=n("G2yP"),u=n("lqrD"),s=n("wuwN"),d=n("r6IF"),l=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:d.r}},f=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,n){n().getIn(["account","account"]).isLoggedIn()?e(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:d.Rb}}({isWork:t})):e(Object(u.h)({authFormType:"SIGN_IN"}))}},b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.slug,n=t.reason,o=t.type;return function(t){return t(Object(i.a)({report:r()({},o,!0)})),t(Object(a.b)({report:r()({},o,null)})),Object(c.e)("report/".concat(o,"/").concat(e),s.b.bind(void 0,{slug:e,reason:n,type:o})).then(function(){t(l()),t(Object(i.a)({report:r()({},o,!1)}))}).catch(function(e){t(Object(a.b)({report:r()({},o,e)})),t(Object(i.a)({report:r()({},o,!1)}))})}},g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.slug,n=t.reason,o=t.type,r=t.id;return function(t){return t(Object(i.a)({report:{comments:!0}})),t(Object(a.b)({report:{comments:null}})),Object(c.e)("report/".concat(r),s.a.bind(void 0,{slug:e,reason:n,type:o,id:r})).then(function(){t(l()),t(Object(i.a)({report:{comments:!1}}))}).catch(function(e){t(Object(a.b)({report:{comments:e}})),t(Object(i.a)({report:{comments:!1}}))})}}},lqrD:function(t,e,n){"use strict";n.d(e,"h",function(){return I}),n.d(e,"q",function(){return P}),n.d(e,"j",function(){return T}),n.d(e,"f",function(){return N}),n.d(e,"g",function(){return C}),n.d(e,"e",function(){return L}),n.d(e,"i",function(){return U}),n.d(e,"o",function(){return W}),n.d(e,"r",function(){return G}),n.d(e,"n",function(){return M}),n.d(e,"m",function(){return R}),n.d(e,"a",function(){return q}),n.d(e,"k",function(){return D}),n.d(e,"l",function(){return E}),n.d(e,"c",function(){return z}),n.d(e,"d",function(){return K}),n.d(e,"p",function(){return x}),n.d(e,"b",function(){return B});var o=n("o0o1"),r=n.n(o),c=n("yXPU"),i=n.n(c),a=n("GBY4"),u=n.n(a),s=n("vJeY"),d=n("fjhF"),l=n("KwH0"),f=n("X3bR"),b=n("G2yP"),g=n("2oVF"),v=n("wgvv"),p=n("oBTp"),h=n("W5jJ"),O=n("MaAo"),j=n("r6IF"),m=n("8GfK"),y=n("WlAH"),k=n("qYEq"),w=function(t){var e={callback:t};return new Promise(function(t){Object(s.e)("bindPhoneToUserCenter",m.b.bind(void 0,e)).then(function(e){t(e)})})},I=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.authFormType,n=t.isRedirect,o=void 0!==n&&n,c=t.callback,a=t.toLoginPage;return function(){var t=i()(r.a.mark(function t(n){var i,s,d,l;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(y.IS_WECHAT&&!a||y.IS_WECHAT&&!y.IS_CHINA)){t.next=3;break}return window.location.href=Object(k.c)("weixin_app"),t.abrupt("return");case 3:i="",s="",t.t0=e,t.next="SIGN_UP"===t.t0?8:"FORGOT"===t.t0?10:"BIND_PHONE"===t.t0?12:(t.t0,21);break;case 8:return i="signup",t.abrupt("break",22);case 10:return n(Object(p.b)("/forgot")),t.abrupt("return");case 12:if(!(y.IS_WECHAT&&a&&y.IS_CHINA)||y.getLoginedFromCookie&&"website_password"===y.getLoginedFromCookie.login_from){t.next=15;break}return i="login",t.abrupt("break",22);case 15:return n(Object(v.x)()),t.next=18,w(c);case 18:return s=t.sent,window.location.href=s.item.bind_phone_url,t.abrupt("return");case 21:i="login";case 22:(d=new u.a(window.location.href,!0)).query.redirect?n(Object(p.b)("/".concat(i,"?redirect=").concat(encodeURIComponent(d.query.redirect)))):(l=d.href.replace(d.origin,""),/^\/(login|signup|forgot|reset_password(\?token=.*)?|settings\/password)\/?$/.test(l)?n(Object(p.b)("/".concat(i))):n(o?Object(p.c)("/".concat(i,"?redirect=").concat(encodeURIComponent(l))):Object(p.b)("/".concat(i,"?redirect=").concat(encodeURIComponent(l)))));case 24:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},P=function(){return{type:j.Ub}},S=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:j.b}},_=function(){return{type:j.n}},T=function(){return{type:j.A}},N=function(){return{type:j.u}},C=function(){return{type:j.v}},L=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y.IS_PILOT,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.IS_PILOT;return function(n,o){return n(Object(b.b)({getAccount:null})),t||o().getIn(["account","account"]).isLoggedIn()?Object(s.d)(e?"[ignore]getAccount":"getAccount",m.f.bind(void 0,{})).then(function(e){var r=e.item;(t||o().getIn(["account","account"]).isLoggedIn())&&n(S({item:r,userLoaded:!0}))}).catch(function(t){n(Object(b.b)({getAccount:t}))}):Promise.resolve()}},F=function(){return function(t){t({type:j.d}),t(S()),t(L()),t(Object(g.o)());var e=Object(d.c)("redirect")||"/";t(Object(p.b)(e))}},U=function(t){window.broadcastLogin=function(e){e&&0===e.status?t(F()):(t(Object(f.a)({signIn:!1})),t(Object(b.b)({signIn:new O.a})))}},A=function(t){t.code&&11008===t.code&&window.nc&&window.nc.reset()},W=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.username,n=t.password,o=t.remember,r=void 0===o?0:o,c=t.captcha;return function(t,o){t(Object(f.a)({signIn:!0})),t(Object(b.b)({signIn:null}));var i={password:n,user_name:e,remembered:!!r,nc:c};return Object(s.e)("signIn/".concat(e),m.k.bind(void 0,i)).then(function(){t(Object(f.a)({signIn:!1})),t(F());var e=o().getIn(["account","account"]).getSlug();Object(l.f)({event:l.e.LOGIN_BUTTON,isSuccess:!0,userId:e})}).catch(function(e){A(e),t(Object(f.a)({signIn:!1})),t(Object(b.b)({signIn:e})),Object(l.f)({event:l.e.LOGIN_BUTTON,isSuccess:!1,reason:e})})}},G=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.isPhone,n=void 0!==e&&e,o=t.accountType,r=void 0===o?0:o,c=t.username,i=t.password,a=t.nickName,u=void 0===a?"":a,d=t.subscription,g=void 0===d||d,v=t.captcha,p=t.pinCode;return function(t){t(Object(f.a)({signUp:!0})),t(Object(b.b)({signUp:null}));var e={account_type:0===r?"personal":"company",nick_name:u,password:i,subscription:g};n?(e.phone=c,e.sms_code=p):(e.email=c,e.nc=v);var o=n?m.n:m.m;return Object(s.e)("signUp/".concat(c),o.bind(void 0,e)).then(function(){t(Object(f.a)({signUp:!1})),t(F()),Object(l.f)({event:l.e.SIGNUP_BUTTON,isSuccess:!0,account_type:0===r?"personal":"company"})}).catch(function(e){A(e),t(Object(f.a)({signUp:!1})),t(Object(b.b)({signUp:e})),Object(l.f)({event:l.e.SIGNUP_BUTTON,isSuccess:!1,reason:e,account_type:0===r?"personal":"company"})})}},M=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.phone,n=t.captcha;return function(t){return t(Object(f.a)({signUp:!0})),t(Object(b.b)({signUp:null})),Object(s.e)("sendSignUpPinCode",m.j.bind(void 0,{phone:e,nc:n})).then(function(){t(Object(f.a)({signUp:!1}))}).catch(function(e){A(e),t(Object(f.a)({signUp:!1})),t(Object(b.b)({signUp:e}))})}},R=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.phone,n=t.captcha;return function(t){return t(Object(f.a)({bindPhone:!0})),t(Object(b.b)({bindPhone:null})),Object(s.e)("sendBindPhonePinCode",m.i.bind(void 0,{phone:e,nc:n})).then(function(){t(Object(f.a)({bindPhone:!1}))}).catch(function(e){A(e),t(Object(f.a)({bindPhone:!1})),t(Object(b.b)({bindPhone:e}))})}},q=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.phone,n=t.pinCode;return function(t){t(Object(f.a)({bindPhone:!0})),t(Object(b.b)({bindPhone:null}));var o={phone:e,sms_code:n};return Object(s.e)("bindPhone",m.a.bind(void 0,o)).then(function(){t(Object(f.a)({bindPhone:!1})),t(F()),t(L()).then(function(){t(Object(p.c)(Object(d.c)("redirect")||"/"))})}).catch(function(e){t(Object(f.a)({bindPhone:!1})),t(Object(b.b)({bindPhone:e}))})}},D=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.password,n=t.password2,o=t.captcha;return function(t){t(Object(f.a)({resetPassword:!0})),t(Object(b.b)({resetPassword:null}));var r={token:Object(d.c)("token"),password:e,confirm_password:n,nc:o};return Object(s.e)("resetPassword",m.g.bind(void 0,r)).then(function(){t({type:j.Eb}),t(Object(f.a)({resetPassword:!1}))}).catch(function(e){A(e),t(Object(f.a)({resetPassword:!1})),t(Object(b.b)({resetPassword:e}))})}},E=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.password,n=t.password2,o=t.smsCode,r=t.phone;return function(t){t(Object(f.a)({resetPassword:!0})),t(Object(b.b)({resetPasswordByPhone:null}));var c={password:e,phone:r,confirm_password:n,sms_code:o};return Object(s.e)("resetPasswordByPhone",m.h.bind(void 0,c)).then(function(){t({type:j.Db}),t(Object(f.a)({resetPassword:!1}))}).catch(function(e){t(Object(f.a)({resetPassword:!1})),t(Object(b.b)({resetPasswordByPhone:e}))})}},z=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.forgotEmail,n=t.captcha;return function(t){t(Object(f.a)({forgot:!0})),t(Object(b.b)({forgot:null}));var o={email:e,nc:n};return Object(s.e)("forgot/".concat(e),m.d.bind(void 0,o)).then(function(){t(_()),t(Object(f.a)({forgot:!1}))}).catch(function(e){A(e),t(Object(f.a)({forgot:!1})),t(Object(b.b)({forgot:e}))})}},K=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.forgotPhone,n=t.captcha;return function(t){t(Object(f.a)({forgot:!0})),t(Object(b.b)({forgot:null}));var o={phone:e,nc:n};return Object(s.e)("forgot/".concat(e),m.e.bind(void 0,o)).then(function(){t(_()),t(Object(f.a)({forgot:!1}))}).catch(function(e){A(e),t(Object(f.a)({forgot:!1})),t(Object(b.b)({forgot:e}))})}},x=function(){return function(t){return t(Object(f.a)({signOut:!0})),t(Object(b.b)({signOut:null})),t(P()),t(Object(g.p)()),Object(s.e)("signOut",m.l.bind(void 0)).then(function(){return t(Object(f.a)({signOut:!1})),t(Object(b.b)({signOut:null})),Promise.resolve()}).catch(function(e){return t(Object(f.a)({signOut:!1})),t(Object(b.b)({signOut:e})),Promise.resolve()})}},B=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.password,n=t.newPassword;return function(t){t(Object(f.a)({changePassword:!0})),t(Object(b.b)({changePassword:null}));var o={old_password:e,new_password:n};return Object(s.e)("changePassword",m.c.bind(void 0,o)).then(function(){h.a.formattedSuccess({id:"message:save_success"}),t({type:j.c}),t(x()),t(Object(f.a)({changePassword:!1}))}).catch(function(e){t(Object(f.a)({changePassword:!1})),t(Object(b.b)({changePassword:e}))})}}},oBTp:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"c",function(){return u}),n.d(e,"a",function(){return s});var o=n("AU/w"),r=n("GBY4"),c=n.n(r),i=n("fjhF"),a=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(n){if(t){var r=t instanceof c.a?t:new c.a(t);r.set("search",r.query),Object(i.h)(r)?n(Object(o.c)(r)):window.location.href=e?Object(i.e)(r)?r.href:"/":r.href}}},u=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(n){if(t){var r=t instanceof c.a?t:new c.a(t);r.set("search",r.query),Object(i.h)(r)?n(Object(o.d)(r)):e?window.location.replace(Object(i.e)(r)?r.href:"/"):window.location.replace(r.href)}}},s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=Math.max(1,e)||1;return{limit:n,offset:n*((Math.max(t,1)||1)-1)}}},pvGr:function(t,e,n){"use strict";n.d(e,"a",function(){return v}),n.d(e,"d",function(){return p}),n.d(e,"b",function(){return h}),n.d(e,"c",function(){return O});var o=n("MVZn"),r=n.n(o),c=n("lSNA"),i=n.n(c),a=n("vJeY"),u=n("X3bR"),s=n("G2yP"),d=n("x+Si"),l=n("lqrD"),f=n("r6IF"),b=n("1r3K"),g=n("oBTp"),v=function(){return{payload:{key:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).key},type:f.f}},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.work,n=t.page,o=t.pageSize,c=t.singlePage,l=void 0!==c&&c;return function(t){var c=e.getKey();t(Object(u.a)({comments:i()({},c,!0)})),t(Object(s.b)({comments:i()({},c,null)}));var b=d.f;return e.isVideo()?b=d.g:e.isPhoto360()&&(b=d.e),Object(a.d)("getWorkComments/".concat(c,"/").concat(n,"/").concat(o),b.bind(void 0,r()({slug:e.getSlug()},Object(g.a)(n,o)))).then(function(e){var r=e.items,a=e.total_items;t(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=t.page;return{payload:{key:e,items:t.items,totalItems:t.totalItems,page:n,pageSize:t.pageSize,singlePage:t.singlePage},type:f.Ab}}({key:c,items:r,totalItems:a,page:n,pageSize:o,singlePage:l})),t(Object(u.a)({comments:i()({},c,!1)}))}).catch(function(e){t(Object(u.a)({comments:i()({},c,!1)})),t(Object(s.b)({comments:i()({},c,e)}))})}},h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.work,n=t.user,o=t.comment,r=t.replyCommentId,c=t.callback;return function(t,g){if(!g().getIn(["account","account"]).isLoggedIn())return t(Object(l.h)({authFormType:"SIGN_IN"})),Promise.resolve();var v="".concat(e.getKey(),"/comment");t(Object(u.a)({comments:i()({},v,!0)})),t(Object(s.b)({comments:i()({},v,null)}));var p=d.a;e.isVideo()?p=d.c:e.isPhoto360()&&(p=d.b);var h={slug:e.getSlug(),content:o};return r&&(h.reply_to=r),n&&n.getSlug()&&(h.users=[n.getSlug()]),Object(a.e)("commentWork/".concat(v),p.bind(void 0,h)).then(function(n){var o=n.item;c&&c({status:b.b}),t(function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:f.Cb}}({key:e.getKey(),item:o})),t({type:f.o}),t(Object(u.a)({comments:i()({},v,!1)}))}).catch(function(e){c&&c({status:b.a}),t(Object(s.b)({comments:i()({},v,e)})),t(Object(u.a)({comments:i()({},v,!1)}))})}},O=function(t,e,n,o,r){return function(c,f){if(!f().getIn(["account","account"]).isLoggedIn())return c(Object(l.h)({authFormType:"SIGN_IN"})),Promise.resolve();var b=t.getKey(),g=e.getKey(),v=e.getSlug(),h="photos";return e.isVideo()?h="videos":e.isPhoto360()&&(h="photo-360s"),c(Object(u.a)({commentDelete:i()({},g,!0)})),c(Object(s.b)({commentDelete:i()({},g,null)})),Object(a.e)("delete/".concat(g,"/").concat(b),d.d.bind(void 0,{key:b,type:h,workSlug:v})).then(function(){c(p({work:e,page:n,pageSize:o,singlePage:r})),c(Object(u.a)({commentDelete:i()({},g,!1)})),c(Object(s.b)({commentDelete:i()({},g,null)}))}).catch(function(t){c(Object(u.a)({commentDelete:i()({},g,!1)})),c(Object(s.b)({commentDelete:i()({},g,t)}))})}}},vJeY:function(t,e,n){"use strict";n.d(e,"a",function(){return g}),n.d(e,"d",function(){return v}),n.d(e,"c",function(){return p}),n.d(e,"e",function(){return h}),n.d(e,"g",function(){return O}),n.d(e,"f",function(){return j}),n.d(e,"b",function(){return m});var o=n("vDqi"),r=n.n(o),c=n("p46w"),i=n.n(c),a=n("3eXy"),u=n("MaAo"),s=n("W5jJ"),d=n("ak8p"),l=n("opw6"),f={},b=function(){},g=function(t){t&&f[t]&&"function"===typeof f[t].cancel&&(f[t].cancel(),delete f[t])},v=function(t,e,n){g(t);var o=r.a.CancelToken.source();return f[t]=o,e(o.token,n).then(function(e){var n=e.data,o=void 0===n?{}:n,r=e.headers,c=e.status,a=e.config,g=void 0===a?{}:a;if(delete f[t],!d.a.test(window.location.pathname)){var v=g.method,p=void 0===v?"":v,h=g.url,O=void 0===h?"":h,j=g.baseURL,m=void 0===j?"":j,y=Object(l.a)(p,O.replace(m,""),i.a.get());y&&y.length>0&&y.map(function(t){var e="message:reputation.".concat(t.action);s.a.formattedReputation({id:e},t.n,null,2)})}if(o instanceof ArrayBuffer)return{data:o,contentType:r["content-type"]?r["content-type"].toLowerCase():""};if(0===o.status)return o;if(9===o.status)throw b(),new u.a({status:401});if(o.data)return o.data;if(204===c)return o;throw new u.a(o.error||o)}).catch(function(e){delete f[t];var n=e instanceof u.a?e:new u.a(e);if((401===n.getCode()||n.isInvalidCSRF())&&t.indexOf("[ignore]")<0)throw b(),n;if(e instanceof r.a.Cancel)return new Promise(function(){});throw n})},p=function(){var t=i.a.get("csrf_token_v2");return t?Promise.resolve(t):v("getCSRFToken",a.a.bind(null,null)).then(function(){var t=i.a.get("csrf_token_v2");if(t)return t;throw new u.a})},h=function(t,e){return p().then(function(){return v(t,e,i.a.get("csrf_token_v2"))})},O=function(t){b=t},j=function(){i.a.remove("csrf_token_v2")},m=function(t){var e=[];return t&&Object.keys(t).forEach(function(n){return t[n]&&e.push("".concat(n,":").concat(t[n]))}),e.length?e.join(","):""}},wgvv:function(t,e,n){"use strict";n.d(e,"m",function(){return _}),n.d(e,"t",function(){return N}),n.d(e,"x",function(){return C}),n.d(e,"k",function(){return L}),n.d(e,"j",function(){return F}),n.d(e,"l",function(){return U}),n.d(e,"o",function(){return A}),n.d(e,"p",function(){return R}),n.d(e,"r",function(){return q}),n.d(e,"f",function(){return D}),n.d(e,"n",function(){return z}),n.d(e,"q",function(){return K}),n.d(e,"w",function(){return x}),n.d(e,"e",function(){return B}),n.d(e,"c",function(){return V}),n.d(e,"b",function(){return J}),n.d(e,"a",function(){return Q}),n.d(e,"d",function(){return Y}),n.d(e,"h",function(){return H}),n.d(e,"g",function(){return Z}),n.d(e,"y",function(){return tt}),n.d(e,"u",function(){return nt}),n.d(e,"v",function(){return ot}),n.d(e,"s",function(){return rt}),n.d(e,"i",function(){return ct});var o=n("J4zp"),r=n.n(o),c=n("lSNA"),i=n.n(c),a=n("MVZn"),u=n.n(a),s=n("vDqi"),d=n.n(s),l=n("vJeY"),f=n("omFR"),b=n("vbt8"),g=n("yxO2"),v=n("MaAo"),p=n("r6IF"),h=n("/PJQ"),O=n("puT/"),j=n("X3bR"),m=n("G2yP"),y=n("JoKX"),k=n("7Qib"),w=n("LV1a"),I=n("fjhF"),P=n("oBTp"),S=n("W5jJ"),_=function(t){if(t)switch(t.getCode()){case 12202:S.a.formattedError({id:"message:contest.publish.contest_join_duplicated"},null,3);break;case 12200:S.a.formattedError({id:"message:contest.publish.contest_not_found"},null,3);break;case 1e3:S.a.formattedError({id:"message:contest.publish.work_not_found"},null,3);break;case 12201:S.a.formattedError({id:"message:contest.publish.submit_expired"},null,3);break;case 12204:S.a.formattedError({id:"message:contest.work.invalid"},null,3);break;case 12205:S.a.formattedError({id:"message:contest.out.of.service"},null,3);break;default:S.a.formattedError({id:"message:contest.publish.unknow"},null,3)}else S.a.formattedSuccess({id:"message:contest.publish.success"},null,3)},T=function(t){if(t)switch(t.getCode()){case 1e3:S.a.formattedError({id:"message:contest.publish.work_not_found"},null,3);break;default:S.a.formattedError({id:"message:contest.publish.unknow"},null,3)}else S.a.formattedSuccess({id:"message:quest.publish.success"},null,3)},N=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).step;return{payload:{step:void 0===t?h.a:t},type:p.cc}},C=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).verify;return{payload:{verify:void 0===t||t},type:p.pc}},L=function(){return{type:p.m}},F=function(){return{type:p.l}},U=function(){return{type:p.x}},A=function(){return{type:p.y}},W=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{payload:{token:t.token,form:t.form},type:p.w}},G=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{payload:{key:t.key,percent:t.percent},type:p.bc}},M=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{payload:{key:t.key,rkey:t.rkey,meta:t.meta},type:p.oc}},R=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{payload:{key:t.key,files:t.files},type:p.Fb}},q=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:p.Gb}},D=function(){return{payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},type:p.g}},E=function(){var t={},e=Object(I.c)("category");e&&(t=u()({},t,{category:e,eventInfoEN:Object(I.c)("eventInfoEN")||"",eventInfoCN:Object(I.c)("eventInfoCN")||""}));try{return JSON.stringify(t)}catch(n){return""}},z=function(t,e){return function(){var n=t.getSlug(),o=t.getAPITypes();return Object(l.e)("publishWorkToContest",f.l.bind(void 0,O.a,o,n,e)).then(function(){return null}).catch(function(t){throw t})}},K=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type;return function(e,n){var o=n(),r=o.getIn(["upload","files"]),c=o.get("files");if(!r.every(function(t){return c.getIn([t,"isCompleted"])}))return Promise.resolve();var i=o.getIn(["upload","token"]),a=o.getIn(["upload","publishMeta"]);if(!a)return Promise.resolve();if("photo"===t){var u=r.map(function(t){var e=c.getIn([t,"meta"])||{},n=e.width,o=e.height,r=e.exif;return{key:c.getIn([t,"key"]),width:n,height:o,exif:r,latitude:a.latitude||"",longitude:a.longitude||""}});if(0===u.size)return Promise.resolve();a.photos=u}return e(Object(j.a)({publish:!0})),e(Object(m.b)({publish:null})),Object(l.e)("saveUpload/".concat(i),f.k.bind(void 0,t,i,a)).then(function(t){e(Object(j.a)({publish:!1})),e(Object(m.b)({publish:null})),e(N({step:h.c}));var o=new g.b(t.item),r=Object(I.c)("event");if(Object(I.c)("private_quest"))e(function(t){return function(){var e=t.getSlug(),n=t.getAPITypes(),o=Object(I.c)("private_quest");return Object(l.e)("publishWorkToQuest",f.m.bind(void 0,o,n,e)).then(function(){return null}).catch(function(t){throw t})}}(o)).then(function(t){T(t)}).catch(function(t){return T(t)}),e(Object(P.b)(Object(I.c)("return")||o.getUrl()));else if(r){var c={competition_info:E(),slug:o.getSlug()};Object(l.e)("participate",b.a.bind(void 0,r,o.getAPITypes(),c)).then(function(){e(Object(P.b)(Object(I.c)("return")||o.getUrl()))}).catch(function(t){e(Object(j.a)({publish:!1})),e(Object(m.b)({publish:t}))})}else if(n().getIn(["upload","joinContest"])){var i=a.club_invitation_code;e(z(o,i?{club_invitation_code:i}:{})).then(function(t){_(t)}).catch(function(t){return _(t)}),e(Object(P.b)(Object(I.c)("return")||o.getUrl()))}else e(Object(P.b)(Object(I.c)("return")||o.getUrl()));return o}).catch(function(t){e(Object(j.a)({publish:!1})),e(Object(m.b)({publish:t}))})}},x=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,n){var o=n().getIn(["upload","files"]);if(!o)return Promise.resolve();var r=o.get(1),c=n().getIn(["files",r,"file"]);if(!c)return Promise.resolve();e(Object(j.a)({upload:i()({},r,!0)})),e(Object(m.b)({upload:i()({},r,null)})),e(G({key:r,percent:0}));var a=new FormData,u=n().getIn(["upload","token"]);a.append("file",c);var s=t?f.f:f.o;return Object(l.e)("/upload/thumbnail",s.bind(void 0,u,a,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.loaded,o=t.total;return e(G({key:r,percent:Object(k.l)(n/o)}))})).then(function(){e(Object(j.a)({upload:i()({},r,!1)})),e(Object(m.b)({upload:i()({},r,null)})),e(M({key:r})),n().getIn(["upload","autoPublish"])&&e(K({type:t?"photo-360":"video"}))}).catch(function(t){e(Object(j.a)({upload:i()({},r,!1)})),e(Object(m.b)({upload:i()({},r,t)}))})}},B=function(){return function(){Object(l.a)("/upload/video/init")}},V=function(){return function(){Object(l.a)("/upload/photo/init")}},J=function(){return function(){Object(l.a)("/upload/photo360/init")}},Q=function(t){return function(){Object(l.a)(t)}},X={},Y=function(){return function(t,e){var n=e().getIn(["upload","files"]);if(n&&n.get(0)){var o=n.get(0);X[o]&&(X[o].cancel(),delete X[o])}}},H=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,n){var o=n(),r=o.getIn(["upload","token"]),c=o.getIn(["upload","files"]);if(e(Q("/upload/thumbnail")),c&&c[1]&&o.getIn(["files",c[1],"isCompleted"])){var i=t?f.d:f.n;return Object(l.e)("/remove/thumbnail",i.bind(void 0,r))}return Promise.resolve()}},Z=function(t){return function(e,n){var o=n(),r=o.getIn(["upload","token"]),c=o.getIn(["files",t,"key"]);return e(Q("/upload/photo/".concat(t))),e(function(){return{payload:{key:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).key},type:p.z}}({key:t})),c?Object(l.e)("/remove/photo",f.i.bind(void 0,r,c)):Promise.resolve()}},$=function(t){return function(e,n){var o=n().getIn(["upload","form"]),r=n().getIn(["files",t,"file"]);if(!r)return Promise.resolve();var c=d.a.CancelToken.source();X[t]=c;var a=new FormData,u=o.url,l=o.fields;Object.keys(l).forEach(function(t){a.append(t,l[t])}),a.append(o.file_field_name,r);var f={onUploadProgress:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.loaded,r=n.total;return e(G({key:t,percent:Object(k.l)(o/r)}))},cancelToken:X[t].token};return Object(s.post)(u,a,f).then(function(o){e(Object(j.a)({upload:i()({},t,!1)})),0===o.data.state?(e(M({key:t})),n().getIn(["upload","autoPublish"])&&e(K({type:"video"}))):e(Object(m.b)({upload:i()({},t,new v.a(o.data))}))}).catch(function(n){e(Object(j.a)({upload:i()({},t,!1)})),e(Object(m.b)({upload:i()({},t,n)}))})}},tt=function(){return function(t,e){var n=e().getIn(["upload","files"]);if(!n||!n.size)return Promise.resolve();var o=n.get(0);return t(Object(j.a)({upload:i()({},o,!0)})),t(Object(m.b)({upload:i()({},o,null),publish:null})),t(G({key:o,percent:0})),e().getIn(["upload","token"])?(t($(o)),Promise.resolve()):Object(l.e)("/upload/video/init",f.c.bind(void 0,{})).then(function(e){var n=e.item,r=n.form,c=n.token;t(W({token:c,form:r})),t($(o))}).catch(function(e){t(Object(j.a)({upload:i()({},o,!1)})),t(Object(m.b)({upload:i()({},o,e)}))})}},et=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,o){var c=o().getIn(["upload","token"]),a=o().getIn(["files",t,"file"]);n(Object(j.a)({upload:i()({},t,!0)})),n(Object(m.b)({upload:i()({},t,null)}));var s=d.a.CancelToken.source();X[t]=s;var b=new FormData;b.append("file",a);var g=e?f.h:f.j;return Object(l.e)("/upload/photo/".concat(t),g.bind(void 0,c,b,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.loaded,r=e.total;return n(G({key:t,percent:Object(k.l)(o/r)}))})).then(function(c){Promise.all([Object(w.b)(a.preview),Object(w.a)(a)]).then(function(i){var a=r()(i,2),s=a[0],d=a[1];n(M(e?{key:t,meta:u()({},s,{exif:d})}:{key:t,rkey:c.item.key,meta:u()({},s,{exif:d})}));var l=d.latitude,f=d.longitude;l&&f&&n(Object(y.d)({params:{latitude:l,longitude:f}})),o().getIn(["upload","autoPublish"])&&n(K({type:e?"photo-360":"photo"}))}).catch(function(e){n(Object(m.b)({upload:i()({},t,e)}))})}).catch(function(e){n(Object(j.a)({upload:i()({},t,!1)})),n(Object(m.b)({upload:i()({},t,e)}))})}},nt=function(t){return function(e,n){t.forEach(function(t){e(Object(j.a)({upload:i()({},t,!0)})),e(Object(m.b)({upload:i()({},t,null),publish:null}))}),e(Object(m.b)({publish:null}));var o=n().getIn(["upload","token"]),r=function(){var o=n();t.forEach(function(t){e(G({key:t,percent:0})),o.getIn(["files",t,"file"])&&e(et(t))})};return o?(r(),Promise.resolve()):Object(l.e)("/upload/photo/init",f.b.bind(void 0,{})).then(function(t){var n=t.item.token;e(W({token:n})),r()}).catch(function(n){t.forEach(function(t){e(Object(j.a)({upload:i()({},t,!1)})),e(Object(m.b)({upload:i()({},t,n)}))})})}},ot=function(){return function(t,e){var n=e().getIn(["upload","files"]);if(!n||!n.size)return Promise.resolve();var o=n.get(0);return t(Object(j.a)({upload:i()({},o,!0)})),t(Object(m.b)({upload:i()({},o,null),publish:null})),t(G({key:o,percent:0})),e().getIn(["upload","token"])?(t(et(o,!0)),Promise.resolve()):Object(l.e)("/upload/photo360/init",f.a.bind(void 0,{})).then(function(e){var n=e.item.token;t(W({token:n})),t(et(o,!0))}).catch(function(e){t(Object(j.a)({upload:i()({},o,!1)})),t(Object(m.b)({upload:i()({},o,e)}))})}},rt=function(t,e){return function(n){var o=t.getUpdateToken();if(!o)return Promise.resolve();var r=t.isPhoto360()?f.e:f.p,c=new FormData;c.append("file",e);var a=t.getKey();return n(Object(m.b)({upload:i()({},a,null)})),n(Object(j.a)({upload:i()({},a,!0)})),Object(l.e)("/update/thumbnail",r.bind(void 0,t.getSlug(),o,c,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.loaded,o=t.total;return n(G({key:a,percent:Object(k.l)(e/o)}))})).then(function(){n(Object(j.a)({upload:i()({},a,!1)})),n(Object(m.b)({upload:i()({},a,null)})),n(M({key:a}))}).catch(function(t){n(Object(j.a)({upload:i()({},a,!1)})),n(Object(m.b)({upload:i()({},a,t)}))})}},ct=function(t){return function(e){e(Q("/update/thumbnail"));var n=t.getUpdateToken();if(n){var o=t.isPhoto360()?f.g:f.q;return Object(l.e)("/remove/thumbnail",o.bind(void 0,t.getSlug(),n))}return Promise.resolve()}}}}]);